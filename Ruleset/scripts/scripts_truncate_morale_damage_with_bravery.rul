extended:
  scripts:
    damageUnit:
      - new: ROSIGMA_dU_truncate_morale_damage_with_bravery
        offset: 99 # goes last
        code: |
          var int bravery;

          unit.Stats.getBravery bravery;

          if and ge bravery 110 lt to_morale 0;
            # debug_log "unit" unit;
            # debug_log "attacker" attacker;
            # debug_log "to_morale was" to_morale;
            set to_morale 0;
          end;
          return;